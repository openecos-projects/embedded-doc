# GPIO API

## 目录
一、核心类型定义（GPIO Types）

1. 引脚编号枚举 (gpio_num_t)

2. 模式控制枚举 (gpio_mode_t)

3. 电平逻辑枚举 (gpio_level_t)

4. GPIO复用功能枚举（gpio_func_t）

二、配置体系（Configuration Object）

1. 驱动配置结构体 (gpio_config_t)

2. 统一配置函数（gpio_config）

三、功能接口（Functional APIs）

1. 设置电平函数（gpio_set_level）

2. 获取电平函数（gpio_get_level）

3. 配置引脚复用功能（gpio_set_function）

4. 设置引脚方向函数（gpio_set_direction）

## 详细介绍

### 一、核心类型定义（GPIO Types）

####  1. 引脚编号枚举（gpio_num_t）
(1) 功能描述

将芯片物理上的管脚（Pin）编号映射为程序可以识别的逻辑常量。

* 作用：确保在调用后续功能函数时，能够精确指定要操作哪一个具体引脚。

* 范围：从GPIO_NUM_0 到 GPIO_NUM_63，涵盖了板卡可能的最大引脚数量。

(2) 参数解析

* 类型：enum（枚举），使用枚举而非宏定义（#define），是为了在编译阶段进行强类型检查，如果误传了一个负数，编译器会直接报错。

* 数值：每个枚举名对应一个整数，例如GPIO_NUM_1对应数字1。
 
#### 2. 模式控制枚举（gpio_mode_t）
(1) 功能描述

因为GPIO引脚必须处于某种模式下才能正常工作，所以这个模式枚举可以定义引脚的数据流向。

* GPIO_MODE_INPUT(0)：输入模式，芯片读取外部信号，常用于读取按键、传感器电平等。
* GPIO_MODE_OUTPUT(1)：输出模式，芯片发送指令，常用于点亮LED、驱动电机等。

(2) 参数解析

* 传入位置：通常作为 gpio_config_t 结构体的成员或者 gpio_set_direction() 函数的第二个参数。

#### 3. 电平逻辑枚举（gpio_level_t）
(1) 功能描述

定义引脚的电压逻辑状态，在数字电路中只有“开”和“关”，将模拟电压量化为数字信号。

* GPIO_LEVEL_LOW(0)：低电平，对应物理上的0V（接地），通常代表逻辑“关”。
* GPIO_LEVEL_HIGH(1)：高电平，对应物理上的3.3V，通常代表逻辑“开”。
* 注意：设置为输入时如果引脚悬空，gpio_get_level 读出的值会受环境电磁干扰而乱跳。

(2) 参数解析

* 传入位置：作为gpio_set_level()函数的第二个参数，决定小灯的亮灭。

#### 4. GPIO复用功能枚举（gpio_func_t）
(1) 功能描述

GPIO引脚通常有很多种工作模式，这个枚举可以定义引脚的工作方式。

* GPIO_FUNCTION_0：通常是通用IO口功能。
* GPIO_FUNCTION_1/2：通常是特定的硬件功能，如串口RX/TX、PWM输出等。
* 作用：通过切换功能号，可以将引脚从普通电平控制切换到高速外设通信模式。

(2) 参数解析

* 传入位置：作为 gpio_set_function() 函数的第二个参数。

### 二、配置体系（Configuration Object）
#### 1.驱动配置结构体 (gpio_config_t)
(1) 功能描述

这是一个配置数据包，将多个配置项打包在一起，实现“声明式”初始化。

* 核心优势：可以先在结构体里填好要求，然后一次性打包给初始化函数。

(2) 成员变量解析

* uint64_t pin_bit_mask：引脚位掩码，一共64位，每一位(bit)代表一个引脚。

      传入值：通常使用位移运算，例如 1ULL << GPIO_NUM_4。

      功能：如果想同时设置 4 号和 5 号引脚，只需传入 (1ULL << 4) | (1ULL << 5) ，它通过 64 位二进制中的“1”来标记哪些引脚被选中。

* gpio_mode_t mode：模式选择。

      传入值：上述定义的 GPIO_MODE_INPUT 或 GPIO_MODE_OUTPUT。

      功能：决定被掩码选中的那些引脚统一进入什么模式。

#### 2. 统一配置函数（gpio_config）
(1) 功能描述

GPIO驱动的总入口，负责解析配置结构体中的信息，并一次性完成多个引脚的硬件初始化配置。

* 批量处理：通过读取结构体中的位掩码，实现对特定一组引脚的同步配置，可以减少CPU与外设总线的通信次数，提升初始化速度。
* 声明式应用：把之前在结构体中配置好的模式和对引脚的要求，落实到真实的硬件寄存器上。

(2) 参数解析

* 参数：const gpio_config_t* config

* 含义：指向配置结构体的指针

### 三、功能接口（Functional APIs）
#### 1.设置电平函数（gpio_set_level）
(1) 功能描述

这是控制硬件的常用函数，用于改变引脚的电压状态，通过发出指令让引脚对外输出3.3V或0V，从而直接驱动LED或者其他继电器的开关。

(2) 参数解析

* 参数1：gpio_num_t gpio_num——指定操作的引脚

* 参数2：gpio_level_t level——设置高电平或者低电平

#### 2.获取电平函数（gpio_get_level）
(1) 功能描述

用于感知外部信号，获取引脚当前的真实电压状态。

* 反馈机制：常用与检测按键是否被按下，或许读取外部传感器发来的触发信号。
* 返回值：返回0代表低电平，返回1代表高电平。

(2) 参数解析

* 参数：gpio_num_t gpio_num——指定要观察的引脚编号

#### 3.配置引脚复用功能（gpio_set_function）
(1) 功能描述

用于切换引脚的硬件身份，将其连接到芯片内部不同的控制器上。

(2) 参数解析

* 参数1：gpio_num_t gpio_num——指定操作的引脚
* 参数2：gpio_func_t func——选择要切换的功能编号

#### 4. 设置引脚方向函数（gpio_set_direction）
(1) 功能描述

在程序运行过程中，动态切换某个特定引脚的输入或输出状态。

(2) 参数解析

* 参数1：gpio_num_t gpio_num——指定要操作的引脚号

* 参数2：gpio_mode_t direction——目标方向

